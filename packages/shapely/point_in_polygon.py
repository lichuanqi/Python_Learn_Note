"""shapely判断点是否在多边形区域内"""

import numpy as np
from matplotlib import pyplot as plt
from shapely.geometry import Polygon, Point


AREA_YONGDU = [
        [
          3.7244094488188972,
          158.6456692913386
        ],
        [
          117.11023622047244,
          131.08661417322833
        ],
        [
          520.259842519685,
          160.2204724409449
        ],
        [
          581.6771653543307,
          191.71653543307087
        ],
        [
          694.275590551181,
          196.44094488188978
        ],
        [
          1184.0393700787401,
          53.921259842519675
        ],
        [
          1289,
          80
        ],
        [
          1289,
          147
        ],
        [
          1121.0472440944882,
          274.39370078740154
        ],
        [
          995.8503937007874,
          350.771653543307
        ],
        [
          847.8188976377953,
          384.6299212598425
        ],
        [
          703.7244094488188,
          394.0787401574803
        ],
        [
          520.259842519685,
          383.8425196850394
        ],
        [
          342.3070866141732,
          340.53543307086613
        ],
        [
          232.85826771653544,
          297.2283464566929
        ],
        [
          165.9291338582677,
          247.62204724409446
        ],
        [
          1.3622047244094486,
          193.29133858267716
        ]
      ]
AREA_DIAOLUO =  [
        [
          1285.6141732283465,
          287.7795275590551
        ],
        [
          909.2362204724409,
          590.9291338582677
        ],
        [
          688.763779527559,
          622.4251968503937
        ],
        [
          454.90551181102364,
          595.6535433070866
        ],
        [
          283.251968503937,
          530.2992125984252
        ],
        [
          143.88188976377953,
          394.8661417322835
        ],
        [
          4.649122807017591,
          394.29824561403507
        ],
        [
          2.894736842105317,
          794.2982456140351
        ],
        [
          1285.3508771929824,
          794.2982456140351
        ]]

# 构造多边形区域
polygon_yd = Polygon(AREA_YONGDU)
polygon_dl = Polygon(AREA_DIAOLUO)


# 虚拟一些点坐标
bbox = [[0.00000000e+00,9.58670914e-01,8.25092651e+02,2.11224762e+02, 9.29006958e+02,2.97285156e+02],
    [0.00000000e+00,9.53488529e-01,6.94683716e+02,2.81105194e+02, 8.61961121e+02,3.90769043e+02],
    [0.00000000e+00,9.45679128e-01,2.67279144e+02,6.87337097e+02, 4.06338684e+02,8.00391846e+02],
    [0.00000000e+00,9.01127458e-01,4.53024231e+02,2.50321442e+02, 6.30916138e+02,3.90920105e+02],
    [0.00000000e+00,8.95638645e-01,-6.54449165e-01,4.93164215e+02, 1.27864044e+02,6.36858582e+02],
    [0.00000000e+00,8.80500436e-01,1.13075403e+03,1.25698128e+02, 1.22159338e+03,2.17073746e+02],
    [0.00000000e+00,8.72301996e-01,3.15411652e+02,2.13101486e+02, 3.95966919e+02,3.00425018e+02],
    [0.00000000e+00,8.59787881e-01,1.94013168e+02,1.96871628e+02, 2.46256348e+02,2.47719528e+02],
    [0.00000000e+00,8.46887231e-01,1.02744385e+03,2.24937927e+02, 1.10782166e+03,3.05231506e+02],
    [0.00000000e+00,8.00661802e-01,1.00007605e+03,1.74358765e+02, 1.07310388e+03,2.25804993e+02]]

points = []
for box in bbox:
    # 计算中心点
    centor_x, centor_y = int((box[2]+box[4])/2), int((box[3]+box[5])/2)
    point = Point(centor_x, centor_y)
    points.append([centor_x, centor_y])
    
    # 判断点是否在多边形区域内
    if polygon_yd.intersects(point):
        print(f'{point} 在 [拥堵] 监控区域内')

    elif polygon_dl.intersects(point):
        print(f'{point} 在 [掉落] 监控区域内')

    else:
        print(f'{point} 在正常区域内')

points_array = np.array(points)
plt.figure()
plt.scatter(points_array[:,0], -points_array[:,1])
plt.show()